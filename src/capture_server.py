from sanic import Sanic
from sanic.response import html, text
import random
import string
import ujson
from datetime import datetime
from html import escape


app = Sanic(name="ghost-honeypot-server")


def get_randomized_content_type_header():

    content_types = [
        "application/java-archive",
        "application/EDI-X12",
        "application/EDIFACT",
        "application/javascript",
        "application/octet-stream",
        "application/ogg",
        "application/pdf",
        "application/xhtml+xml",
        "application/x-shockwave-flash",
        "application/json",
        "application/ld+json",
        "application/xml",
        "application/zip",
        "application/x-www-form-urlencoded",
        "text/css",
        "text/csv",
        "text/html",
        "text/plain",
        "text/xml"
    ]
    random.shuffle(content_types)
    return ",".join(content_types)


def get_randomized_server_header():
    # Taken from here: https://github.com/rapid7/recog/blob/main/xml/http_servers.xml
    server_headers = [
        ''.join(random.choices(string.ascii_uppercase + string.ascii_lowercase + string.digits, k=random.randint(0, 64))),  # do this to randomize the server header length
        "$ProjectRevision: 4.0.2.38 $",
        "$ProjectRevision: 4.2 $",
        "$ProjectRevision: 6.0.1.5 $",
        "$ProjectRevision: Last Checkpoint: 4.2.2.13 $",
        "(Any of you quaids got a smint?) WEB SERVER",
        "(BOSS) Web Server/2.1.0",
        "(Erlang OTP/17)",
        "(Unix)",
        "(Win32) DAV/2 mod_ssl/2.2.9 OpenSSL/0.9.8i mod_autoindex_color",
        "(Win32) OpenSSL/1.0.1l",
        "(Windows 2000 5.0 x86)",
        "(Windows Server 2008/6.1 amd64)",
        "************",
        "15dbd20f-7fc0-910a-349c-94a3d569e732",
        "192.168.0.4:9999",
        "192.168.0.5:65535",
        "19dec2003",
        "2.2.23 istio-envoy",
        "26Oct2018",
        "29dec2003",
        "2wire Gateway",
        "3S_WebServer",
        "4fd7d672-bbd6-f059-9dff-51e02d6e25ee",
        "5.1.2600 2/Service Pack 3, UPnP/1.0, TVersity Media Server",
        "5.2.3790 2/Service Pack 1, UPnP/1.0, TVersity Media Server",
        "58f5b853-36b6-597e-16c6-4610e7fd83a4",
        "6.0.6000 2/, UPnP/1.0, TVersity Media Server",
        "6.1.7600 2/, UPnP/1.0, TVersity Media Server",
        "6.2.8400 2/, UPnP/1.0, TVersity Media Server",
        "6.2.9200 2/, UPnP/1.0, TVersity Media Server",
        "831",
        "a74b7cd4-4a4e-4115-7a48-1c7ebb4ae45b",
        "Abyss/2.0.0.20-X1-Win32 AbyssLib/2.0.0.20",
        "Abyss/2.12.1-X1-MacOS X AbyssLib/2.12",
        "Abyss/2.14-X1-macOS AbyssLib/2.14",
        "Abyss/2.3.2-X1-Win32 AbyssLib/2.3.2",
        "Abyss/2.7.0.0-X1-Win32",
        "Abyss/2.8.0.5-X2/B2-Win32",
        "AbyssLib/2.7.0.0",
        "AbyssLib/2.8.0.1",
        "ADB Broadband HTTP Server",
        "adong",
        "Agranat-EmWeb/R4_01",
        "Agranat-EmWeb/R5_1_2",
        "Agranat-EmWeb/R5_2_4",
        "Agranat-EmWeb/R5_2_6",
        "aiohttp/4.0.0a1",
        "airCube",
        "AirTunes/377.30.01",
        "AkamaiGHost",
        "AliyunOSS",
        "Allegro-Software-RomPager/ 2.10",
        "Allegro-Software-RomPager/4.01",
        "Allegro-Software-RomPager/4.30b3",
        "alphapd/2.1.8",
        "Amazon SimpleDB",
        "Amazon-Cloud-Drive",
        "AmazonS3",
        "AmazonSnowball",
        "AMT",
        "Apache",
        "apache",
        "Apache Coyote/1.0",
        "Apache Tableau",
        "Apache Tomcat",
        "Apache Tomcat/4.0.6 (HTTP/1.1 Connector)",
        "Apache Tomcat/4.1.12 (HTTP/1.1 Connector)",
        "Apache Tomcat/4.1.27-LE-jdk14 (HTTP/1.1 Connector)",
        "Apache Tomcat/9.0.5",
        "Apache-AdvancedExtranetServer/2.0.44 (Mandrake Linux/11mdk) mod_perl/1.99_08 Perl/v5.8.0 mod_ssl/2.0.44 OpenSSL/0.9.7a PHP/4.3.1 mod_jk2/2.0.0",
        "Apache-AdvancedExtranetServer/2.0.47 (Mandrake Linux/6.12.92mdk) mod_perl/1.99_09 Perl/v5.8.1 mod_ssl/2.0.47 OpenSSL/0.9.7b PHP/4.3.2",
        "Apache-AdvancedExtranetServer/2.0.47 (Mandrake Linux/6.3.92mdk) mod_ssl/2.0.47 OpenSSL/0.9.7b PHP/4.3.2",
        "Apache-AdvancedExtranetServer/2.0.48 (Mandrake Linux/6.8.100mdk) mod_perl/1.99_11 Perl/v5.8.3 mod_ssl/2.0.48 OpenSSL/0.9.7c PHP/4.3.4",
        "Apache-AdvancedExtranetServer/2.0.48 (Mandrake Linux/6mdk) PHP/4.3.4",
        "Apache-AdvancedExtranetServer/2.0.53 (Mandrakelinux/PREFORK-9mdk) mod_ssl/2.0.53 OpenSSL/0.9.7e PHP/4.3.10 mod_perl/1.999.21 Perl/v5.8.6",
        "Apache-Coyote/1.1",
        "Apache/0.6.5",
        "Apache/1",
        "Apache/1.1.3",
        "Apache/1.2.42 (PalmOS)",
        "Apache/1.3.28 (SolutionIP) mod_perl/1.28 mod_ssl/2.8.15 OpenSSL/0.9.7b",
        "Apache/1.3.28 (Unix)",
        "Apache/1.3.28 (Unix) mod_auth_pam/1.1.1",
        "Apache/1.3.28 (Unix) mod_ssl/2.8.15",
        "Apache/1.3.31 (Unix)",
        "APACHE/1.3.9",
        "Apache/2",
        "Apache/2.0.43 (Win32) mod_jk/1.2.2-beta-1",
        "Apache/2.2.0",
        "Apache/2.2.3 (Red Hat)",
        "Apache/2.2.4 (Win32) PHP/5.2.2",
        "Apache/2.2.4 (Win32) PHP/5.2.3",
        "Apache/2.2.9",
        "Apache/2.4.12",
        "Apache/2.4.29 (Ubuntu)",
        "Apache/2.4.9 (Win32)",
        "APN HTTPD V1.4",
        "App-webs/ ioLogik Web Server/1.0",
        "app07",
        "appnode/ccenter H264DVR 1.0",
        "Arcadyan",
        "ASP.NET",
        "Asterisk/1.8.9",
        "Astra",
        "ATS/7.0.0 Jetty(winstone-2.8)",
        "AutobahnPython/21.3.1",
        "AV-TECH AV787 Video Web Server",
        "Avaya CMBE/2",
        "Avaya CMBE/2.0.0",
        "AvigilonGateway/1.0",
        "Avocent DSView 3/3",
        "Avocent DSView 3/3.7.0.71",
        "avtech/1.0",
        "Avtech/1.0",
        "awselb/2.0",
        "axhttpd/1.4.0",
        "axhttpd/1.5.3",
        "B&R Web Server  Ver. {2-250416-25}",
        "ballerina",
        "ballerina/0.982.1-SNAPSHOT",
        "ballerina/0.991.0",
        "BarracudaHTTP 4.0",
        "BaseHTTP/0.3",
        "BaseHTTP/0.3 Python/2.7.18",
        "BaseHTTP/0.6 Python/3.10.6",
        "BBC 05.20.050; coda 10.00.123",
        "BBC 06.00.083; ovbbccb 06.00.083",
        "BBC 11.10.035; ovbbccb 11.10.035",
        "BBC 11.13.007; ovbbccb unknown version",
        "BBC 2.6.0.7; com.hp.openview.bbc.LLBServer 2.6.0.7",
        "BBC 2.6.0.7; com.hp.openview.Coda 0.0.1",
        "beegoServer:1.11.1",
        "beegoServer:1.12.0",
        "beegoServer:2.0.0",
        "bfe/1.0.8.18",
        "BigIP",
        "bks400",
        "BlueCoat-Security-Appliance",
        "BlueIris-HTTP/1.1",
        "BlueServer/4.8.6.3",
        "BlueServer/5.1.0.4",
        "BlueServer/5.5.4.1",
        "Boa/0.92p OS-9 Version",
        "Boa/0.93.15",
        "Boa/0.93.15 (with Intersil Extensions)",
        "Boa/0.94.11",
        "Boa/0.94.13",
        "Boa/0.94.14",
        "Boa/0.94.14rc18-ipcam",
        "Boa/0.94.14rc19",
        "Boa/0.94.14rc20",
        "Boa/0.94.14rc21",
        "box",
        "BRCM HTTP Server",
        "BRCM400/1.0",
        "Caddy",
        "Cambium HTTP Server",
        "camera",
        "Cassini/5.0.4.0",
        "cc-web/1.6.3",
        "cdn",
        "CE_C",
        "CE_E",
        "CenteHTTPd/1.1",
        "chainpoint-node",
        "Check Point SVN foundation",
        "Cherokee",
        "Cherokee/0.2.7",
        "Cherokee/1.2.101 (UNIX)",
        "CherryPy/10.2.2",
        "CherryPy/3",
        "CherryPy/3.1.2",
        "CherryPy/3.2.2",
        "CherryPy/3.2.5",
        "CherryPy/4.0.0",
        "CherryPy/8.6.0",
        "Cimer AR ZLMediaKit(git hash:b4207240,branch:master,build time:Nov  2 2021 11:36:02)",
        "Cisco-CcspCwmpTcpCR/1.0",
        "cisco-IOS",
        "Citrix Web PN Server",
        "CJServer/1.1",
        "Clayster.Library.Internet/1.1",
        "cloudflare",
        "cloudflare Cloud",
        "cloudflare-nginx",
        "CloudFront",
        "com.hp.openview.bbc.LLBServer 2.6.8.1",
        "com.hp.openview.Coda 0.0.1",
        "CommuniGatePro/5.2.20",
        "CommuniGatePro/6.2.16v",
        "CompaqHTTPServer/4.1",
        "CompaqHTTPServer/9.9 HP System Management Homepage",
        "CompaqHTTPServer/9.9 HP System Management Homepage/2.1.5.146",
        "CompaqHTTPServer/9.9 HP System Management Homepage/3.0.1.73 httpd/2.2.6+",
        "CompaqHTTPServer/9.9 HP System Management Homepage/6.0.0.96 httpd/2.2.6+",
        "Conexant-EmWeb/R6_1_0",
        "Contiki/2.4 http://www.sics.se/contiki/",
        "convesio/2.1",
        "Coruscant ZTE web server 1.0 ZTE corp 2015.",
        "Couchbase Server",
        "CouchDB/2.1.0",
        "Cougar/9.01.01.3841",
        "Cowboy",
        "cPanel Transmission Reposify",
        "CPE-SERVER/1.0",
        "cpsrvd",
        "cpsrvd/11.44.3.0",
        "CPWS",
        "CPython/3.6.8",
        "CPython/3.7.7",
        "CPython/3.8.5",
        "CPython/3.9.6",
        "Crestron Webserver",
        "Cross Web Server",
        "Crow/0.3",
        "Crow/master",
        "CSI Web Server 1.05",
        "CUPS/1.1",
        "CUPS/1.7 IPP/2.1",
        "CUPS/2.2",
        "CuteBi Network Tunnel, (%>w<%)",
        "cwpsrv",
        "d45964bf-d48c-477c-8655-56bb369797b6",
        "d7b452-d70-1255-4515-9b56f13a6dab",
        "darkhttpd/1.12",
        "darkhttpd/1.13.from.git",
        "darkstat/3.0.718",
        "DasanNetwork Solution alphapd",
        "David-WebBox/12.00a (1291)",
        "Debian/4.0 UPnP/1.0 miniupnpd/1.0",
        "Debian/4.0r8 DLNADOC/1.50 UPnP/1.0 MiniDLNA/1.0",
        "Debian/wheezy/sid UPnP/1.1 MiniUPnPd/1.8",
        "debut/1.30",
        "demce.tk",
        "Destiny Tengine SY8033 TRMB/1.2",
        "DGuard Center 7.1.6.9",
        "DIR-825 web server/v1.00",
        "DNVRS-Webs",
        "Docker/1.10.3 (linux)",
        "Docker/1.11.1 (linux)",
        "Docker/17.03.0-ce (linux)",
        "Docker/17.03.3-ce (linux)",
        "Docker/18.09.4 (linux)",
        "Docker/19.03.8 (linux)",
        "Docker/19.03.9 (linux)",
        "Docker/20.10.2 (linux)",
        "Docker/20.10.6 (linux)",
        "DOSarrest",
        "Dr.COM Server",
        "DS67x0",
        "DVRDVS-Webs",
        "DWS",
        "E2EE Server 2.0",
        "E2EE WebSocket Server/0.7.0",
        "e7fd6736-5b0f-4af1-54a0-c95a00f208b",
        "eHTTP v2.0",
        "EHTTP/1.1",
        "ELAN Controller",
        "Eltex TAU-1.IP",
        "Eltex TAU-72",
        "Embedded server v1.0",
        "Embedthis-Appweb/3.2.3",
        "Embedthis-Appweb/3.3.1",
        "Embedthis-Appweb/3.4.2",
        "Embedthis-http",
        "Embedthis-http/4.0.0",
        "EnergyICT RTU 101-F25CE1-1524",
        "envoy",
        "Etherpad 44370f1 (http://etherpad.org)",
        "Eudemon Auth-Http Server 1.0",
        "ev-compat",
        "eWON",
        "EWS-NIC3/6.31",
        "EWS-NIC4/13.39",
        "EWS-NIC4/13.40",
        "Ews/0",
        "Ews/0.1",
        "EZproxy ZK Web Server",
        "f09f73f0-cac6-422-3660-32ac658c5ae7",
        "f24ddd9c-e2a6-23c-ec95-4563173bbe",
        "fasthttp",
        "FC03-HTTPS",
        "Fedora/10 UPnP/1.0 MiniUPnPd/1.4",
        "Fedora/8 UPnP/1.0 miniupnpd/1.0",
        "FedoraCore/6 UPnP/1.0 miniupnpd/1.0",
        "fibjs",
        "flowproxy Web Server",
        "FlowWeb/1.4.28",
        "FreeBSD/8.2-RELEASE-p4 DLNADOC/1.50 UPnP/1.0 MiniDLNA/1.0.24",
        "FUHO-DVR",
        "GeoHttpServer",
        "GeoWebServer 5.0.0.0",
        "Gerenciado por StoreHosting.com.br Saia",
        "gf-app Nexus/3.0.1-01 (OSS)",
        "GFE/1",
        "GFE/1.3",
        "GHost",
        "GlassFish",
        "GlassFish Server Open Source Edition  4.1.1 SRS/4.0.198(Leo)",
        "GlassFish Server Open Source Edition  4.1.2",
        "GlassFish Server Open Source Edition 3.1.2.2",
        "GlassFish Server Open Source Edition 4.0",
        "GlassFish Server Open Source Edition 4.1",
        "GoAhead-http",
        "GoAhead-Webs",
        "GoAhead-Webs/2.5.0",
        "GoAhead-Webs/2.5.0 PeerSec-MatrixSSL/3.4.2-OPEN",
        "Goahead/2.5.0 PeerSec-MatrixSSL/3.2.1-OPEN",
        "GoAheadWebs",
        "Google Web",
        "GoOryx/1.0.5",
        "gSOAP/2.7",
        "gSOAP/2.8",
        "gunicorn",
        "gunicorn/18.0",
        "gunicorn/19.4.5",
        "gunicorn/19.7.0",
        "gunicorn/19.8.1",
        "gunicorn/19.9.0",
        "gunicorn/20.0.4",
        "gws",
        "GWS/100.0 Easy-html",
        "h2o/2.3.0-DEV@1d12c355",
        "H3C-CVM",
        "H3C-CVM 5049",
        "H3C-Miniware-Webs",
        "Hanlong Unicron v1.0",
        "HeiTel GmbH Web Server [V1.15/V1.14/V1.3]",
        "HeiTel GmbH Web Server [V1.26/V1.15/V1.7]",
        "HFS 2.1 beta17",
        "HFS 2.2e Gnway Web Server",
        "HFS 2.3 beta",
        "HFS 2.3c",
        "HFS 2.4rc2",
        "HID-Web",
        "hidden",
        "Hikvision-Webs",
        "Hikvision-Webs Keil-EWEB/2.0 streamserver",
        "Hipcam secure",
        "hmhttpd/1.24-20160808",
        "HP Apache-based Web Server/1.3.26 (Unix)",
        "HP Apache-based Web Server/1.3.26 (Unix) mod_ssl/2.8.9 OpenSSL/0.9.6c",
        "HP HTTP Server; Hewlett-Packard HP Designjet T520 36in - ABC123; Serial Number: 0123456789; Built:Tue Sep 09, 2014 08:32:54AM {012345678901}",
        "HP HTTP Server; HP Officejet 6500 E709n - CB057A; Serial Number: abc123; Rainbow Built:Sat Dec 13, 2008 10:58:21AM {abc123, ASIC id 0x00ffc2105}",
        "HP HTTP Server; HP Photosmart C309a series - CC335A; Serial Number: abc123; Vader Built:Wed Apr 15, 2009 11:40:58AM {abc123, ASIC id 0x00280004}",
        "HP Web Jetadmin 10.3.85669",
        "HP Web Jetadmin 10.3.91358 (10.3 SR5)",
        "HP Web Jetadmin/2 (Win32) mod_auth_sspi/1.0.1 mod_ssl/2.0.50 OpenSSL/0.9.6m",
        "HP Web Jetadmin/2.0.50 (Win32) mod_auth_sspi/1.0.1 mod_ssl/2.0.50 OpenSSL/0.9.6m",
        "HP-ChaiServer/2.2",
        "HP-ChaiSOE/1.0",
        "HP-iLO-Server/1.30",
        "HPSMH",
        "HtNanoHttpd",
        "hts_server",
        "HTTP Server 1.0",
        "http server 1.0",
        "Http Server tinyproxy/1.8.3",
        "HTTP Server/5.0",
        "httpd",
        "HTTPd",
        "Httpd",
        "HTTPD 1.0",
        "httpd 1.0",
        "httpd 1.1",
        "HTTPD Henry/1.1",
        "httpd Mini web server 1.0",
        "Httpd/1.0",
        "httpd/2.0",
        "httpd_gargoyle/1.0 14mar2008",
        "HttpProxy HTTPD_gw 1.0 Jetty(6.1.11)",
        "Huawei Auth-Http Server 1.0",
        "Huawei-ATP-IGD P-660HW-T1 v3",
        "huohuo",
        "Hydra/0.1.8",
        "Hydra/0.1.8 GnuTLS/2.12.23",
        "IBM-HTTP-Server/1.0",
        "IBM_HTTP_Server",
        "IBM_HTTP_SERVER",
        "IBM_HTTP_Server/1.3.12 Apache/1.3.12 (Unix)",
        "IBM_HTTP_SERVER/1.3.19.2  Apache/1.3.20 (Win32)",
        "IBM_HTTP_SERVER/1.3.28.1-PK16139  Apache/1.3.28 (Unix)",
        "IBM_HTTP_Server/2.0.42.2-PK25355 Apache/2.0.47 (Unix) DAV/2",
        "IBM_HTTP_Server/2.0.47.1 Apache/2.0.47 (Unix) DAV/2 PHP/4.3.8",
        "IBM_HTTP_Server/2.0.47.1-PK01070 Apache/2.0.47 (Win32) PHP/5.0.4",
        "IBM_HTTP_Server/6.0 Apache/2.0.47 (Unix) DAV/2",
        "IBM_HTTP_Server/6.0.2 Apache/2.0.47 (Unix)",
        "IBM_HTTP_Server/6.0.2.19 Apache/2.0.47 (Unix)",
        "IBM_HTTP_Server/6.1 Apache/2.0.47 (Win32) PHP/5.1.1",
        "IBM_HTTP_Server/7.0.0.9 (Unix)",
        "Icecast 2.4.0-kh13",
        "Icecast 2.4.2",
        "Icecast 2.4.3",
        "Icecast 2.4.4",
        "IceWarp/12.0.2.0 x64",
        "IdeaWebServer/0.83.415",
        "IdeaWebServer/0.83.74",
        "IdeaWebServer/v0.70",
        "iis8.0",
        "Indy/10.0.52",
        "Indy/9.0.11",
        "Indy/9.00.10",
        "infosec/1.0.0",
        "Infra911",
        "Intel(R) Active Management Technology",
        "Intel(R) Active Management Technology 9.1.30",
        "Intel(R) Standard Manageability 5.0.50",
        "Intel(R) Standard Manageability 9.0.3",
        "INTELEKTRON WEB SERVER",
        "Intoto Http Server v1.0",
        "IPCamera Login",
        "IPCamera-Webs/2.5.0",
        "iPlanet-Web-Proxy-Server/3.6",
        "iPlanet-Web-Proxy-Server/3.6-SP5",
        "ipos/7.0 UPnP/1.0 TL-WR740N/1.0",
        "ipos/7.0 UPnP/1.0 TL-WR740N/1.0/2.0",
        "ipos/7.0 UPnP/1.0 TL-WR740N/4.0",
        "ipos/7.0 UPnP/1.0 TL-WR741N/1.0/2.0",
        "ipos/7.0 UPnP/1.0 TL-WR741N/4.0",
        "ipos/7.0 UPnP/1.0 TL-WR841N/6.0/7.0",
        "ipos/7.0 UPnP/1.0 TL-WR841N/8.0",
        "ipos/7.0 UPnP/1.0 TL-WR940N/1.0",
        "ipos/7.0 UPnP/1.0 TL-WR941N/2.0",
        "IPP/2.1",
        "Ipswitch-IMail/5.08",
        "Ipswitch-IMail/7.07",
        "Ipswitch-IMail/8.05",
        "IS2 Web Server 1.36",
        "ISOS/9.0 UPnP/1.0 Conexant-EmWeb/R6_1_0",
        "iSpy HFS 2.4.0 RC6",
        "istio-envoy",
        "iVMS-Web Nexus/3.9.0-01 (OSS)",
        "IX Series IX2105 (magellan-sec) Software, Version 9.6.12A, MAINTENANCE RELEASE SOFTWARE",
        "IX Series IX2106 (magellan-sec) Software, Version 10.2.20, RELEASE SOFTWARE",
        "Java Composer Server 2.1",
        "java/1.6.0_07",
        "java/1.6.0_31",
        "JAWS/1.0 Aug 21 2013",
        "JAWS/1.0 Aug 26 2015",
        "JAWS/1.0 Mar  6 2017 K3",
        "JAWS/1.0 Sep 18 2018",
        "JAWS/1.0 Sep 30 2016",
        "JC-HTTPD/1",
        "JC-HTTPD/1.11.14",
        "JC-SHTTPD/1",
        "JC-SHTTPD/1.17.20",
        "Jetty (Bluecat Networks)",
        "Jetty(1.4.5)",
        "Jetty(6.1.12.rc2)",
        "Jetty(6.1.14)",
        "Jetty(6.1.26)",
        "Jetty(6.1.26.hwx)",
        "Jetty(7.6.0.v20120127)",
        "Jetty(7.6.13.v20130916)",
        "Jetty(7.6.9.v20130131)",
        "Jetty(8.1.10.v20130312)",
        "Jetty(8.2.0.v20160908)",
        "Jetty(9.2.14.v20151106)",
        "Jetty(9.4.43.v20210629)",
        "Jetty(9.4.9.v20180320)",
        "Jetty(9.4.z-SNAPSHOT)",
        "Jetty(i-jetty 3.8)",
        "Jetty(winstone-2.9)",
        "Jetty/3.1.8",
        "Jetty/4.0.1 (SunOS 5.8 sparc)",
        "Jetty/4.2.23 (SunOS/5.9 sparc java/1.4.2_04)",
        "Jetty/4.2.x (VxWorks/WIND version 2.9 ppc java/1.1-rr-std-b12)",
        "Jetty/5.1.10",
        "Jetty/5.1.10 (Linux/2.6.12 i386 java/1.5.0_05)",
        "Jetty/5.1.4 (Windows Server 2008 R2/6.1 x86 java/1.5.0_22",
        "Jexus/5.8.2.21",
        "JFinal 4.9.17",
        "jjhttpd v0.1.0",
        "K2 web",
        "kangle/3.5.19",
        "kangle/3.5.8.2",
        "Keil-EWEB/2.1",
        "Kerio Connect 7.0.1",
        "Kerio Connect 8.2.2",
        "Kerio Connect 8.3.1",
        "Kerio Connect 9.2.12 patch 1",
        "Kerio Connect 9.2.8 patch 1",
        "Kerio Control Embedded Web Server",
        "Kestrel",
        "Kestrel Sanoil Bayi Portal\" vws 1.7.12",
        "kong/0.30-enterprise-edition",
        "kong/0.35-1-enterprise-edition",
        "KWS-1043N-Svr",
        "kx-ns1000",
        "LHS WindRiver-WebServer/4.7",
        "Lighttpd",
        "lighttpd",
        "lighttpd (SliTaz GNU/Linux)",
        "lighttpd webserver",
        "lighttpd/1.3.7 (Mar 23 2007/16:00:15)",
        "lighttpd/1.4.16",
        "lighttpd/1.4.19",
        "lighttpd/1.4.25-devel-v2.2.24-45-gc66fb0e4",
        "lighttpd/1.4.26-devel-v14.07.2",
        "lighttpd/1.4.28-devel-10177 webs/",
        "lighttpd/1.4.28-devel-135:137M",
        "lighttpd/1.4.28-devel-171:172M",
        "lighttpd/1.4.28-devel-9217",
        "lighttpd/1.4.32",
        "lighttpd/1.4.32-devel-20015M",
        "lighttpd/1.4.37",
        "lighttpd/1.4.54",
        "lighttpd/1.4.55",
        "Linux aeserver",
        "Linux UPnP/1.0",
        "Linux UPnP/1.0 Huawei-ATP-IGD",
        "Linux UPnP/1.0 Sonos/34.16-37101 (ZP120)",
        "Linux UPnP/1.0 Sonos/39.2-47040c (ZPS1)",
        "Linux UPnP/1.0 Sonos/47.2-59120 (ZPS3)",
        "Linux, STUNNEL/1.0, DIR-820LW Ver 2.00W",
        "Linux, STUNNEL/1.0, DIR-850L Ver 1.09",
        "Linux, WEBACCESS/1.0, DIR-645 Ver 1.04",
        "Linux, WEBACCESS/1.0, DIR-850L Ver 1.09",
        "Linux, WEBACCESS/1.0, DIR-850L Ver 1.14WW",
        "Linux, WEBACCESS/1.0, DSL-2890AL Ver 1.01",
        "Linux, WEBACCESS/1.0, DSL-2890AL Ver AU_1.02.10",
        "Linux-amd64-2.6.18-238.9.1.el5, UPnP/1.0, PMS/1.52.1",
        "Linux-i386-2.6.33.2, UPnP/1.0, PMS/1.21.1",
        "LINUX/2.4 UPnP/1.0",
        "Linux/2.4.18_mvl30-ixdp425, UPnP/1.0, Intel SDK for UPnP devices/1.3.1",
        "Linux/2.4.20-46.7asp, UPnP/1.0, Portable SDK for UPnP devices/1.6.17",
        "Linux/2.4.21 UPnP/1.0 miniupnpd/1.0",
        "Linux/2.6.10-iop1-1, UPnP/1.0, Portable SDK for UPnP devices/1.4.1",
        "Linux/2.6.10_dev-malta-mips2_fp_le, UPnP/1.0, Intel SDK for UPnP devices /1.2",
        "Linux/2.6.12-5.1-brcmstb-dm800, UPnP/1.0, Portable SDK for UPnP devices/1.6.0",
        "Linux/2.6.12.6-arm1-040, UPnP/1.0, Portable SDK for UPnP devices/1.6.5.2",
        "Linux/2.6.12.6-VENUS, UPnP/1.0, Portable SDK for UPnP devices/1.6.10",
        "Linux/2.6.13, UPnP/1.0, Portable SDK for UPnP devices/1.6.0",
        "Linux/2.6.18_pro500-davinci_N03A_IPCAM_1.0-g5c649288-dirty, UPnP/1.0, Portable SDK for UPnP devices/1.6.6",
        "Linux/2.6.23.17_stm23_0125dorade00 UPnP/1.0 DLNADOC/1.50 Portable SDK for UPnP devices/1.4.6-5",
        "Linux/2.6.28, UPnP/1.0, Portable SDK for UPnP devices/1.6.10",
        "Linux/2.6.28-11-server, UPnP/1.0, Portable SDK for UPnP devices/1.6.6",
        "Linux/2.6.28-17-generic, UPnP/1.0, Portable SDK for UPnP devices/1.6.6",
        "Linux/2.6.28.1-xxxx-std-ipv4-32, UPnP/1.0, Portable SDK for UPnP devices/1.4.3",
        "Linux/2.6.29.6-217.2.3.fc11.i686.PAE UPnP/1.0 miniupnpd/1.0",
        "Linux/2.6.32-220.7.1.el6.x86_64, UPnP/1.0, Portable SDK for UPnP devices/1.6.14",
        "Linux/2.6.32-24-generic, UPnP/1.0, Portable SDK for UPnP devices/1.6.6",
        "Linux/2.6.32-279.1.1.el6.x86_64, UPnP/1.0, Portable SDK for UPnP devices/1.6.13",
        "Linux/2.6.32-279.11.1.el6.x86_64, UPnP/1.0, Portable SDK for UPnP devices/1.6.14",
        "Linux/2.6.32-279.14.1.el6.x86_64, UPnP/1.0, Portable SDK for UPnP devices/1.6.14",
        "Linux/2.6.32-279.14.1.el6.x86_64, UPnP/1.0, Portable SDK for UPnP devices/1.6.15",
        "Linux/2.6.36+ DLNADOC/1.50 UPnP/1.0 MiniDLNA/1.0",
        "Linux/2.x UPnP/1.0",
        "Linux/2.x.x, UPnP/1.0, pvConnect UPnP SDK/1.0, Twonky UPnP SDK/1.1",
        "Linux/3.0.8 UPnP/1.0 DLNADOC/1.50 Portable SDK for UPnP devices/1.6.6",
        "Linux/Cross_compiled UPnP/1.0 miniupnpd/1.0",
        "LiteSpeed",
        "LiteSpeed/5.2.8 Enterprise",
        "LIVE555 Streaming Media v2020.04.24",
        "localhost",
        "LOS HTTP Server 1.0",
        "Lotus",
        "Lotus Expeditor Web Container/6",
        "Lotus Expeditor Web Container/6.1",
        "Lotus-Domino",
        "Lotus-Domino/0",
        "Lotus-Domino/5.0.8",
        "Lotus-Domino/Release",
        "Lotus-Domino/Release-4.6.7(Intl)",
        "MAGI 1.0",
        "MapbarServer Snorkel/02.03.00.04",
        "Mastodon",
        "Mathopd/1.5p6",
        "Mbedthis-Appweb/0.0.0",
        "Mbedthis-Appweb/2",
        "Mbedthis-AppWeb/2.4.0",
        "Mbedthis-Appweb/2.4.0",
        "Mbedthis-Appweb/2.4.2",
        "mcdhttpd/1.2",
        "Medusa/2118",
        "Medusa/3.41",
        "mginx",
        "mHttp 0.1.6296.32466",
        "Mhz server",
        "micro_httpd",
        "Microplex emHTTPD/1",
        "Microplex emHTTPD/1.0",
        "Microplex emHTTPD/1.1",
        "Microsoft-Azure-Application-Gateway/v2",
        "Microsoft-HTTPAPI/2.0",
        "Microsoft-IIS",
        "Microsoft-IIS/10.0",
        "Microsoft-IIS/5.0",
        "Microsoft-IIS/5.1",
        "Microsoft-IIS/6.0",
        "Microsoft-IIS/7.0",
        "Microsoft-IIS/7.5",
        "Microsoft-IIS/8.0",
        "Microsoft-IIS/8.5",
        "Microsoft-WinCE/4.10",
        "Microsoft-WinCE/4.20",
        "Microsoft-WinCE/5.0",
        "Microsoft-WinCE/6.00",
        "Mikrotik",
        "Mikrotik HttpProxy",
        "Mini Dome IP Camera",
        "Mini web server 1.0 ZTE corp 2005.",
        "mini_httpd",
        "mini_httpd/1 23jun2000",
        "mini_httpd/1.14 23jun2000",
        "mini_httpd/1.19",
        "mini_httpd/1.21 18oct2014",
        "mini_httpd/1.24 10May2016",
        "mini_httpd/1.27 07Mar2017",
        "mini_httpd/1.30",
        "MinIO Console IST OIS",
        "MiniServ/1.530 Mini web server 1.0 Skyworth corp 2017.",
        "MiniServ/1.610",
        "MiniServ/1.941",
        "MiniServ/1.970",
        "miniupnpd/1.0",
        "MobileSMARTS/5.2.46.14758",
        "MochiWeb/1.0",
        "mod_ssl/2.2.0",
        "mongo/2.0",
        "Mongoose/6.11",
        "Mongoose/6.6",
        "Mongrel 1",
        "Mongrel 1.1.5",
        "mORMot (Windows)",
        "MoxaHttp/1.0",
        "MoxaHttp/2.2",
        "MoxaHttp/2.3",
        "MQCache/2.1.0",
        "MS-MFC-321-1/1.1",
        "MS-SDK-HttpServer/1.0",
        "mt-daapd/0.2.4.1",
        "mt-daapd/svn-999",
        "MWS 0.01",
        "mxhttpd/2.19-MX Jun 16 2020",
        "NET-DK 1.1",
        "NET-DK/1.0",
        "NetApp//8.1RC2",
        "NetApp/7.2.1.1",
        "NetApp/7.3.4P1",
        "NetBox Version 2.8 Build 4128",
        "NetCache appliance (NetApp/5.3.1R3)",
        "NetCache appliance (NetApp/5.4R2D2)",
        "NetCache appliance (NetApp/5.6.1D22)",
        "NetCache appliance (NetApp/6.0.2P1)",
        "NetCache appliance (NetApp/6.0.4)",
        "NetCache appliance (NetApp/6.1RC2)",
        "netis/1.0.1",
        "Netscape-Enterprise/3.5.1",
        "Netscape-Enterprise/3.6 SP3",
        "Netscape-Enterprise/6.0",
        "Netwave IP Camera",
        "Network_Module/1.0 (RX-V581)",
        "Nexus/3.0.0-03 (OSS)",
        "Nexus/3.13.0-01 (OSS)",
        "Nexus/3.18.0-01 (OSS)",
        "Nexus/3.19.1-01 (OSS)",
        "Nexus/3.7.1-02 (OSS)",
        "nginx",
        "nginx + Phusion Passenger",
        "nginx + Phusion Passenger 5.1.11",
        "Nginx 4D/18.3.0",
        "nginx-more",
        "nginx-reuseport/1.13.4",
        "nginx-upupw/1.8.0",
        "nginx-V-ddos",
        "nginx/0.7.64",
        "nginx/0.8.53",
        "nginx/0.8.53 + Phusion Passenger 3.0.0 (mod_rails/mod_rack)",
        "nginx/1.0.15",
        "nginx/1.10.1",
        "nginx/1.14.2",
        "nginx/1.19.1",
        "nginx/1.9.11",
        "nginx/1.9.9",
        "Niagara Web Server/1.1",
        "Niagara Web Server/3.8.111",
        "nostromo 1.9.4",
        "nPerf/2.2.0 2019-04-02",
        "nPerf/2.2.6 2021-05-08",
        "NSC/0.6.4 (JVM)",
        "ntopng 2.3.160415 [Debian stretch/sid (i686)]",
        "ntopng 2.3.160415 [Debian stretch/sid (x86_64)]",
        "ntopng 2.5.161119 [Debian 7.11 [i686][Debian GNU/Linux 7.11 (wheezy)]]",
        "ntopng 3.2.171221 [x86_64-unknown-linux-gnu [x86_64][CentOS release 6.9 (Final)]]",
        "ntopng 3.3.180306 [Debian 7.10 [x86_64][Debian GNU/Linux 7.10 (wheezy)]]",
        "ntopng 3.4.0 [armv7-unknown-freebsd12.2-gnueabihf [arm][]]",
        "ntopng 3.4.210629 [ [x86_64][CentOS Linux release 7.5.1804 (Core) ]]",
        "ntopng 3.6.181022 [x86_64-unknown-linux-gnu [x86_64][CentOS Linux release 7.5.1804 (Core) ]]",
        "ntopng 3.7.180907 [Debian 9.1 [x86_64][Debian GNU/Linux 9.1 (stretch)]]",
        "ntopng 3.8.201001 [amd64-unknown-freebsd11.3 [amd64][]]",
        "ntopng 3.8.220621 [i686-pc-linux-gnu [i686][]]",
        "ntopng 3.9.200305 [Debian 8.11 [x86_64][Debian GNU/Linux 8.11 (jessie)]]",
        "ntopng 4.2.201125 [x86_64-unknown-linux-gnu [x86_64][]]",
        "ntopng 4.2.201206 [Debian 10.6 [aarch64][]]",
        "ntopng 4.2.210309 [Debian buster/sid [x86_64][Ubuntu 18.04.5 LTS]]",
        "ntopng 4.3.210624 [Debian 9.12 [x86_64][Debian GNU/Linux 9.12 (stretch)]]",
        "ntopng 4.3.211226 [x86_64-unknown-linux-gnu [x86_64][CentOS Linux release 8.4.2105]]",
        "ntopng 5.0.220112 [FreeBSD 12.3 [amd64][FreeBSD 12.3]]",
        "ntopng 5.4.220721 [Debian bullseye/sid [x86_64][Ubuntu 20.04.4 LTS]]",
        "ntopng 5.4.221110 [x86_64-unknown-linux-gnu [x86_64][CentOS Linux release 7.9.2009 (Core)]]",
        "ntopng 5.4.221124 [Debian 11.0 [x86_64][Debian GNU/Linux 11 (bullseye)]]",
        "ntopng 5.5.220724 [Debian 11.1 [armv7l][Raspbian GNU/Linux 11 (bullseye)]]",
        "ntopng 5.5.221116 [Debian 10.8 [x86_64][Debian GNU/Linux 10 (buster)]]",
        "ntopng 5.5.221127 [Debian 11.4 [aarch64][Debian GNU/Linux 11 (bullseye)]]",
        "ntopng 5.5.221211 [Debian 10.11 [armv7l][Raspbian GNU/Linux 10 (buster)]]",
        "Nucleus/4.3 UPnP/1.0 Virata-EmWeb/R6_2_0",
        "NVR EXT SERVER",
        "nws/1.0",
        "nxahttp/2.1.7415.0",
        "o2switch-PowerBoost-v3",
        "oatpp/1.2.5",
        "Oce Express WebTools",
        "Octopus Deploy/ Microsoft-HTTPAPI/2.0",
        "OpenCms/11.0.2",
        "openresty",
        "openresty Payara Micro #badassfish",
        "openresty/1.11.2.1",
        "openresty/1.11.2.5",
        "openresty/1.13.6.2",
        "openresty/1.15.8.1",
        "openresty/1.15.8.2",
        "openresty/1.17.8.2",
        "openresty/1.19.3.1",
        "openresty/1.19.3.2",
        "openresty/1.19.9.1 - PasteWSGIServer/0.5",
        "openresty/1.9.15.1",
        "openresty/1.9.3.1",
        "OpenSSL/0.9.7g",
        "OpenSSL/0.9.8d",
        "OpenSSL/1.0.1g",
        "OpenVPN-AS",
        "OPNsense",
        "OPNsense gen5th/1.33.00",
        "Oracle Containers for J2EE",
        "Oracle HTTP Server Powered by Apache",
        "Oracle HTTP Server Powered by Apache/1.3.12 (Unix) ApacheJServ/1.1 mod_ssl/2.6.4 OpenSSL/0.9.5a",
        "Oracle HTTP Server Powered by Apache/1.3.19 (Unix) mod_plsql/3.0.9.8.3b PHP/4.3.10 mod_fastcgi/2.2.10 mod_perl/1.25 mod_oprocmgr/1.0",
        "Oracle HTTP Server Powered by Apache/1.3.19 (Win32) mod_ssl/2.8.1 OpenSSL/0.9.5a mod_fastcgi/2.2.10 mod_oprocmgr/1.0 mod_perl/1.25",
        "Oracle XML DB/Oracle Database",
        "Oracle XML DB/Oracle9i Enterprise Edition Release 9 - Production",
        "Oracle XML DB/Oracle9i Enterprise Edition Release 9.2.0.1.0 - Production",
        "Oracle XML DB/Oracle9i Release 9.2.0.1.0 - Production",
        "Oracle-Application-Server-10g",
        "Oracle-Application-Server-10g OracleAS-Web-Cache-10g/9.0.4.0.0 (G;max-age=405077281+0;age=0)",
        "Oracle-Application-Server-10g/10.1.2.0.2 Oracle-HTTP-Server",
        "Oracle-Application-Server-10g/10.1.2.2.0 Oracle-HTTP-Server (Unix) mod_plsql/10.1.2.2.0 mod_ossl/10.1.2.0.0 mod_perl/1.29 OracleAS-Web-Cache-10g/10.1.2.0.2 (N;ecid=89116016562,0)",
        "Oracle-Application-Server-10g/10.1.2.2.0 Oracle-HTTP-Server OracleAS-Web-Cache-10g/10.1.2.2.0 (N;ecid=153541209221,0)",
        "Oracle-Application-Server-10g/9.0.4.1.0 Oracle-HTTP-Server",
        "Oracle-Application-Server-11g",
        "Oracle-Application-Server-11g   (N;ecid=7862868532763,0:1)",
        "Oracle-Application-Server-11g Oracle-Web-Cache-11g/11.1.1.3.0",
        "Oracle-Application-Server-11g Oracle-Web-Cache-11g/11.1.1.6.0 (G;max-age=0+0;age=0;ecid=9345078839670331,0:1)",
        "Oracle-Application-Server-11g/10.2.3.6.0",
        "Oracle-Application-Server-12c",
        "Oracle-HTTP-Server",
        "Oracle-HTTP-Server-11g",
        "Oracle-HTTP-Server-11g Oracle-Web-Cache-11g/11.1.1.9.0 (H;max-age=214748356+0;age=61086;ecid=32073608106620,0:1)",
        "Oracle-HTTP-Server-12.2.1.4.0/2.4.39",
        "Oracle-HTTP-Server-12c",
        "Oracle-HTTP-Server-12c/12.1.3.0.0",
        "Oracle-Web-Cache-11g/11.1.1.6.0",
        "Oracle-Web-Cache-11g/11.1.1.6.0 (G;max-age=0+0;age=0;ecid=86359748033185402,0:1:1)",
        "Oracle-Web-Cache-11g/11.1.1.6.0 (N;ecid=8590109479546459,0:1)",
        "Oracle-Web-Cache-11g/11.1.1.9.0 (TH;max-age=60+30;age=55;ecid=23248098121,0)",
        "Oracle9iAS/9.0.2.3.0 Oracle HTTP Server Oracle9iAS-Web-Cache/9.0.2.3.0 (N)",
        "Oracle9iAS/9.0.3.1 Oracle HTTP Server Oracle9iAS-Web-Cache/9.0.3.1.0 (N)",
        "OrientDB Server v.2.2.22 (build fb2b7d321ea8a5a5b18a82237049804aace9e3de) Ag [47]",
        "OrientDB Server v.2.2.37 (build a7541e7ceeabf592dd9a7b2928b6c023cbc73193, branch 2.2.x)",
        "OS 1.0 UPnP/1.0",
        "Output-Streamer/0.2",
        "PAM360",
        "PanWeb Server/ -",
        "Payara Server 5.2021.7 #badassfish",
        "PCD2M5540/1.10.16",
        "PDR-Jseries",
        "PDR-M800/1.0",
        "PeerSec-MatrixSSL/3.1.3-OPEN",
        "PeerSec-MatrixSSL/3.1.3-OPEN HP HTTP Server; HP ENVY 7640 series - E4W43A; Serial Number: TH73P4S0Q0063T; Built:Tue May 26, 2020 07:08:30AM {NSM2CN2022AR} SY8045",
        "PeerSec-MatrixSSL/3.4.2-OPEN",
        "PeerSec-MatrixSSL/3.9.5-OPEN ver2.4 rev0",
        "PHP/4.4.2-1build1",
        "PHP/5.1.1",
        "PHP/5.1.2",
        "PHP/5.2.6",
        "PHP/5.5.11",
        "PHP/5.6.8",
        "phpiis.com",
        "PLKWebServer",
        "PMP",
        "Polycom",
        "Polycom SoundPoint IP Telephone HTTPd",
        "PRAVIS/1.0",
        "Prometheus",
        "proxygen-bolt",
        "PRTG/13.1.2.1462",
        "PRTG/19.4.52.3515",
        "pve-api-daemon/3.0",
        "Python/2.6.3",
        "Python/2.7.1",
        "Python/2.7.10",
        "Python/2.7.12",
        "Python/2.7.16",
        "Python/2.7.17",
        "Python/2.7.5",
        "Python/2.7.6",
        "Python/3.4 aiohttp/1.0.5",
        "Python/3.5.3 Embedded HTTP Server.",
        "Python/3.6.2",
        "Python/3.6.9",
        "Python/3.7 websockets/10.1",
        "Python/3.7.3",
        "Python/3.8",
        "Python/3.8 aiohttp/3.7.4.post0",
        "Python/3.8.10",
        "Python/3.8.2",
        "QTSS/5.0 (Build/452; Platform/MacOSX; Release/Panther; )",
        "QTSS/5.0.3.3 (Build/452.22.4; Platform/MacOSX; Release/Panther; Update/Security; )",
        "Qualvision -HTTPServer",
        "RainLoop",
        "Rapid Logic/1",
        "Rapid Logic/1.1",
        "Raptor Simple, Secure Web Server 1.0",
        "Realtek/V1.3 Web Server/2.1.0",
        "ReeCam IP Camera",
        "RemObjects SDK for .NET",
        "Resin/2.1.13",
        "Resin/2.1.s030827",
        "Resin/3.0.19",
        "Resin/3.0.23",
        "Resin/3.1.12",
        "Resin/3.1.6",
        "Resin/3.1.8",
        "Resin/4.0.36",
        "Resin/4.0.40",
        "Resin/4.0.58",
        "RG/Device 10.x",
        "RGOS HTTP-Server/1.1 PRTG",
        "Roku/10.0.0",
        "Roku/10.0.0 UPnP/1.0",
        "RomPager/4.07",
        "RomPager/4.07 UPnP/1.0",
        "RomPager/4.51",
        "router webs",
        "Router Webserver",
        "Router Webserver lwIP/1.4.0 (http://savannah.nongnu.org/projects/lwip)",
        "Ruijie Server",
        "Ruijie Servrer",
        "Rumpus",
        "Rumpus Start HTTP-Server/1.1",
        "Safedog WAF",
        "Safedog/4.0.0",
        "Saia PCD3.M5340/1.16.69",
        "Sanoil Bayi Portal",
        "SAP Internet Graphics Server",
        "SAP J2EE Engine",
        "SAP NetWeaver Application Server",
        "SAP NetWeaver Application Server (ICM)",
        "Satrack HTTP Server",
        "ScreenConnect/19.3.25270.7185-3841999031",
        "ScreenConnect/6.3.13446.6374-4039728469 Microsoft-HTTPAPI/2.0",
        "SDK 4.2.0.0",
        "Security Console",
        "Seeyon-Server/1.0 GW",
        "SentinelKeysServer/1",
        "SentinelKeysServer/1.0",
        "SentinelKeysServer/1.3.1",
        "SentinelProtectionServer/7",
        "SentinelProtectionServer/7.0",
        "SentinelProtectionServer/7.1",
        "SentinelProtectionServer/7.3",
        "SEPM",
        "Server Beaver Medusa/1.12",
        "servermgrd",
        "ServerTech-AWS/v7.1g-b1",
        "ServerTech-AWS/v8.0x",
        "Servlet 2.4; JBoss-4.2.3.GA (build: SVNTag=JBoss_4_2_3_GA date=200807181439)/JBossWeb-2.0",
        "Servlet 2.5; JBoss-5.0/JBossWeb-2.1",
        "sfcHttpd",
        "shield",
        "Simple, Secure Web Server 1.1",
        "SimpleHTTP/0.6",
        "SimpleHTTP/0.6 Python/2.7.6",
        "SimpleHTTP/0.6 Python/3.4.0",
        "SimpleHTTPWithUpload/0.1",
        "SinforHttpd/1.0",
        "SiteScope/9.0 04:38:55 2007-08-19 build 911",
        "SMG-1016M",
        "SMG1016M",
        "SMG2",
        "SMG3016",
        "Solstice 2.0",
        "SonicWALL",
        "SonicWALL SP-XML",
        "SonicWALL SSL-VPN Web Server",
        "SonicWALL SSLVPN Web Server",
        "Sophos Email Appliance",
        "SoundPoint IP Telephone",
        "SOYAL Technology WebServer 2.0",
        "Splunkd",
        "squid",
        "Squid",
        "Squid/2.3.STABLE1",
        "squid/2.7.STABLE9",
        "squid/3.1.20",
        "squid/3.2.9-BZR",
        "squid/3.3.8",
        "squid/3.5.12",
        "squid/3.5.20",
        "squid/3.5.25",
        "squid/3.5.27",
        "squid/4.10",
        "squid/4.11",
        "squid/4.13",
        "squid/4.13-VCS",
        "squid/4.14",
        "squid/4.4",
        "SRS/3.0.85(OuXuli)",
        "SRS/4.0.161(Leo) Linux, HTTP/1.1, DIR-850L Ver 1.13",
        "SRS/4.0.177(Leo)",
        "SRS/4.0.201(Leo)",
        "SRS/5.0.12(Leo)",
        "sslvpn 1.0",
        "sthttpd/2.27.0 03oct2014",
        "STR_SettingServer",
        "Streamer 21.10",
        "StreamSystem",
        "StreamSystem 4.0",
        "Stronghold/3.0 Apache/1.3.19 RedHat/3014c",
        "Stronghold/4.0 Apache/1.3.22 (Unix) mod_ssl/2.8.7 OpenSSL/0.9.6c mod_perl/1.26",
        "success web server/1.0.0",
        "Sun GlassFish Enterprise Server v2.1",
        "Sun Java System Application Server 9.1_02",
        "Sun Java System Application Server Platform Edition 9.0",
        "Sun Java System Application Server Platform Edition 9.0_01",
        "Sun-ILOM-Web-Server/1.0",
        "Sun-Java-System-Web-Proxy-Server/4.0",
        "Sun-Java-System-Web-Proxy-Server/4.0.2",
        "Sun-Java-System-Web-Server/7.0",
        "Sun-Java-System/Application-Server",
        "Sun-ONE-Web-Server/6.1",
        "sundray",
        "Sunny WebBox",
        "SuperSign MS-MFC-HttpSvr/1.0",
        "support@arraynetworks.net",
        "Supports only GET",
        "sw-cp-server",
        "Switch K2P Router",
        "swoole-http-server",
        "Symantec Endpoint Protection Manager",
        "t1-httpd/1.4.43",
        "Tableau",
        "TargetWeb/2011.0 (TargetOS)",
        "TeamSpeak Server 3.13.2",
        "TeamSpeak Server 3.13.3",
        "TeamSpeak Server 3.13.6",
        "Tengine",
        "Tengine/1.5.2",
        "Tengine/2.0.0",
        "Tengine/2.1.2",
        "Tengine/2.2.3",
        "Tengine/2.3.0",
        "Tengine/2.3.2",
        "Tengine/2.3.3",
        "TestApp-1.0.0 CVM",
        "thin 1 codename Flaming Astroboy",
        "thin 1.2.4 codename Flaming Astroboy",
        "thttpd",
        "thttpd TwistedWeb/18.4.0",
        "thttpd/2.04 10aug98",
        "thttpd/2.20b",
        "thttpd/2.21b PHP/20030920",
        "thttpd/2.23beta1 26may2002",
        "thttpd/2.25b",
        "thttpd/2.25b-lxc 29dec2003",
        "thttpd/2.29 23May2018 web server",
        "Tieline",
        "Titan K1 TornadoServer/6.1",
        "tivo-httpd-1:20.7.4.RC35-D18-6:D18",
        "Tomcat Web Server/3.1M1 (JSP 1.1; Servlet 2.2; Java 1.3.1; AIX 5.3 ppc; java.vendor=IBM Corporation)",
        "Tomcat Web Server/3.2.2 (JSP 1.1; Servlet 2.2; Java 1.3.1; Windows 2000 5.0 x86; java.vendor=Sun Microsystems Inc.)",
        "Tomcat Web Server/3.2.2 (JSP 1.1; Servlet 2.2; Java 1.4.2_13; Windows 2003 5.2 x86; java.vendor=Sun Microsystems Inc.)",
        "Tomcat Web Server/3.3.1 Final ( JSP 1.1; Servlet 2.2 )",
        "Tomcat/2.1",
        "TopWebServer",
        "TornadoServer/4.4.3",
        "TornadoServer/5.0.2",
        "TornadoServer/5.1",
        "TornadoServer/6.0.3",
        "TOS/1.12.1",
        "TOSHIBA TEC CORPORATION",
        "TP-LINK HTTPD/1.0",
        "TP-LINK Router",
        "TR069 client TCP connection request Server JAWS/1.0 Apr  8 2014",
        "tr069 http server",
        "tsbox",
        "Twisted/13.0.0 TwistedWeb/9.0.0",
        "Twisted/17.9.0 TwistedWeb/9.0.0",
        "TwistedWeb/12.0.0",
        "TwistedWeb/12.1.0",
        "TwistedWeb/13.2.0",
        "TwistedWeb/14.0.0",
        "TwistedWeb/16.2.0",
        "TwistedWeb/16.4.0",
        "TwistedWeb/16.5.0rc2",
        "TwistedWeb/17.9.0",
        "TwistedWeb/19.7.0",
        "TwistedWeb/2.5.0",
        "TwistedWeb/20.3.0",
        "TwistedWeb/8.2.0",
        "Ubuntu/10.04 UPnP/1.0 miniupnpd/1.0",
        "Ubuntu/10.10 UPnP/1.0 miniupnpd/1.0",
        "Ubuntu/7.10 UPnP/1.0 miniupnpd/1.0",
        "Ubuntu/9.04 UPnP/1.0 miniupnpd/1.0",
        "uc-httpd 1.0.0",
        "uc-httpd/1.0.0",
        "udpxy 1.0-23.10 (prod) standard [Linux 3.18.67 x86_64]",
        "uhttpd/1.0.0",
        "ulwsd/1.0.1-20140331",
        "Unknown",
        "Unknown/0.0 UPnP/1.0 Conexant-EmWeb/R6_1_0",
        "Unknown/0.0 UPnP/1.0 GlobespanVirata-EmWeb/R6_1_0",
        "Unknown/0.0 UPnP/1.0 Virata-EmWeb/R6_1_0",
        "Unkown BaseHTTP/0.3",
        "Unspecified, UPnP/1.0, Unspecified",
        "UOS",
        "UPnP/1.0",
        "UPnP/1.0 GEM ver1 openresty/1.15.8.3",
        "UPnP/1.0 MiniUPnPd/1.6",
        "UPnP/1.0, DLNADOC/1.50, Platinum/0.5.1",
        "UPnP/1.0, DLNADOC/1.50, Platinum/0.5.3.0",
        "UPnP/1.0, DLNADOC/1.50, Platinum/0.5.4.0",
        "UPnP/1.0, DLNADOC/1.50, Platinum/0.6.6.0",
        "UPnP/Tomato 1.28.0000 MIPSR2-132 K26 USB VPN UPnP/1.1 MiniUPnPd/1.9",
        "UPnP/Tomato 1.28.9014 MIPSR2-RAF-v1.3g K26 UPnP/1.1 MiniUPnPd/1.8",
        "UPnP/Tomato MIPSR2-140 K26 UPnP/1.1 MiniUPnPd/2.0",
        "UPnP/Tomato MIPSR2Toastman-RT K26 UPnP/1.1 MiniUPnPd/2.0",
        "UPS_Server/1",
        "UPS_Server/1.0",
        "uvicorn",
        "VA Web Server Virtual Web 0.9",
        "Varnish",
        "Varnish Caddy v0.11.1",
        "Varnish-Cache",
        "VCS-VIDOS-NVR",
        "VDNServer/2017",
        "VIAWEB system/1.0.0 (http://www.viawebsystem.com.br)",
        "Virata-EmWeb/R5_3_0",
        "Virata-EmWeb/R5_3_2",
        "Virata-EmWeb/R6_0_1",
        "Virata-EmWeb/R6_1_0",
        "Virata-EmWeb/R6_2_0",
        "Virata-EmWeb/R6_2_1",
        "VNC Server Enterprise Edition/E4.5.1 (r27892)",
        "VNC Server Personal Edition/P4.5.3 (r39012)",
        "w3httpd/1.0",
        "waitress",
        "WCY_WEBServer/1.0",
        "WCY_WEBServer/2.0",
        "Web Server 1.1",
        "Web server boss/1.0",
        "WEB-ROUTER",
        "Web-Server/3.0",
        "webfs/1.21",
        "Webio",
        "WebLogic Server 7.0 SP4 Tue Aug 12 11:22:26 PDT 2003",
        "WebLogic Server 8.1 SP3 Tue Jun 29 23:11:19 PDT 2004 404973",
        "WebLogic WebLogic Server 6.1 SP4  11/08/2002 21:50:43 #221641",
        "Webs HP HTTP Server; HP HP OfficeJet Pro 8720 - D9L19A; Serial Number: CN81HC6060; Built:Wed Jan 27, 2021 02:31:26PM {WMP1CN2105AR}",
        "WebServer (SerenityOS)",
        "WebServer HFS 2.4.0 RC7",
        "WebServer(ipcamera)",
        "webserver/0.0.0",
        "WebServer/1.0",
        "webserver/1.0",
        "WebServer/1.2.0",
        "WebServer/2.0",
        "WebServer2",
        "WebSocket++/0.4.0",
        "WebSocket++/0.7.0",
        "WebSocket++/0.8.0-dev",
        "WebSocket++/0.8.1",
        "WebSocket++/0.8.2",
        "WebSocket++/2011-09-25",
        "websocket-sharp/1.0",
        "WebSockify",
        "WebSphere Application Server/5.0",
        "WebSphere Application Server/6.1",
        "WebSphere Application Server/7.0",
        "webswing.org Server Version 11.0",
        "Werkzeug/0.10.4",
        "Werkzeug/0.12.2",
        "Werkzeug/0.14.1",
        "Werkzeug/0.16.1",
        "Werkzeug/0.8.3",
        "Werkzeug/0.9.4",
        "Werkzeug/1.0.1",
        "Werkzeug/2.0.1",
        "Wildfly 8",
        "WildFly/10",
        "WildFly/8",
        "WIN32 Linux/2.6.30.9-cig-4, UPnP/1.0, Portable SDK for UPnP devices/1.6.18",
        "Windows Server 2008 R2/6.1 amd64",
        "Windows_7-x86-6.1, UPnP/1.0, PMS/1.10.51",
        "Windows_7-x86-6.1, UPnP/1.0, PMS/1.20",
        "Windows_7-x86-6.1, UPnP/1.0, PMS/1.20.409",
        "Windows_7-x86-6.1, UPnP/1.0, PMS/1.20.412",
        "Windows_7-x86-6.1, UPnP/1.0, PMS/1.22.0",
        "Windows_7-x86-6.1, UPnP/1.0, PMS/1.71.0",
        "Windows_7-x86-6.1, UPnP/1.0, PMS/1.72.0",
        "Windows_XP-amd64-5.2, UPnP/1.0, PMS/1.54.0",
        "Windows_XP-x86-5.1, UPnP/1.0, PMS/1.20.400",
        "WindRiver-WebServer/4.5",
        "Wing FTP Server(customer name here)",
        "Winstone Servlet Engine v1.0.5",
        "WintenDo Payara Server  4.1.1.164 #badassfish",
        "WMSServer/2.0.1.0",
        "WowzaStreamingEngine/4.6.0.04x",
        "WowzaStreamingEngine/4.7.7",
        "WSGI Server",
        "WSGIServer/0.1 Python/2.7.18",
        "WSGIServer/0.2",
        "WSGIServer/0.2 CPython/3.10.5",
        "WSO2 Carbon Server",
        "wts/1.2",
        "WVS Web Hosting by Dot Enterprise Co.,Ltd (http://www.de.co.th/)",
        "WWW Server/1.1",
        "X-Web dcs-lig-httpd",
        "X-web nhttpd/3.4.0 (yhttpd_core/1.3.2)",
        "Xavante 2.2.0 embeded",
        "Xfinity Broadband Router Server",
        "Xitami",
        "xxxxxxxx-xxxxx",
        "yawcam/0.6.0",
        "yealink embed httpd",
        "yuntuc",
        "ZLMediaKit(git hash:1292ec6,branch:master,build time:Sep 29 2021 18:28:24)",
        "ZLMediaKit-5.0(build in Apr  8 2021 03:17:35)",
        "ZTE web server 1.0 ZTE corp 2015.",
        "ZXIC corp 2005.",
        "ZXVEVMC01"
    ]

    random.shuffle(server_headers)
    return ' '.join(server_headers)


def get_randomized_xpowered_header():

    x_powered_headers = [
        "ASP.NET",
        "PHP/5.6.40",
        "PHP/7.4.33",
        "PHP/7.4.32",
        "PleskLin",
        "PHP/7.3.33",
        "PHP/7.2.34",
        "PHP/7.4.30",
        "PHP/5.4.16",
        "WP Engine",
        "PHP/7.0.33",
        "PHP/7.1.33",
        "PHP/8.0.25",
        "PHP/5.3.29",
        "Nginx",
        "Express",
        "PHP/5.4.41",
        "PHP/5.4.45",
        "PHP/5.2.17",
        "PHP/5.5.38"
    ]

    random.shuffle(x_powered_headers)

    return ' '.join(x_powered_headers)


def get_randomized_response():

    fake_etc_shadow = "root:$6$ByHk8jSd5L5y90Y0$4Miz2j4ljZIfgMjevgJzw1n5RG8XKHz5B5y5g.knUXlDn4Qk4mF5Z1nA4KjboTo1XlabcDeF/20AJQYmykFT/:18689:0:99999:7:::"

    fake_etc_passwd = """
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:102:105::/nonexistent:/usr/sbin/nologin
systemd-timesync:x:103:106:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
syslog:x:104:111::/home/syslog:/usr/sbin/nologin
_apt:x:105:65534::/nonexistent:/usr/sbin/nologin
tss:x:106:112:TPM software stack,,,:/var/lib/tpm:/bin/false
uuidd:x:107:115::/run/uuidd:/usr/sbin/nologin
systemd-oom:x:108:116:systemd Userspace OOM Killer,,,:/run/systemd:/usr/sbin/nologin
tcpdump:x:109:117::/nonexistent:/usr/sbin/nologin
avahi-autoipd:x:110:119:Avahi autoip daemon,,,:/var/lib/avahi-autoipd:/usr/sbin/nologin
usbmux:x:111:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin
dnsmasq:x:112:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin
kernoops:x:113:65534:Kernel Oops Tracking Daemon,,,:/:/usr/sbin/nologin
avahi:x:114:121:Avahi mDNS daemon,,,:/run/avahi-daemon:/usr/sbin/nologin
cups-pk-helper:x:115:122:user for cups-pk-helper service,,,:/home/cups-pk-helper:/usr/sbin/nologin
rtkit:x:116:123:RealtimeKit,,,:/proc:/usr/sbin/nologin
whoopsie:x:117:124::/nonexistent:/bin/false
sssd:x:118:125:SSSD system user,,,:/var/lib/sss:/usr/sbin/nologin
speech-dispatcher:x:119:29:Speech Dispatcher,,,:/run/speech-dispatcher:/bin/false
nm-openvpn:x:120:126:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/usr/sbin/nologin
saned:x:121:128::/var/lib/saned:/usr/sbin/nologin
colord:x:122:129:colord colour management daemon,,,:/var/lib/colord:/usr/sbin/nologin
geoclue:x:123:130::/var/lib/geoclue:/usr/sbin/nologin
pulse:x:124:131:PulseAudio daemon,,,:/run/pulse:/usr/sbin/nologin
gnome-initial-setup:x:125:65534::/run/gnome-initial-setup/:/bin/false
hplip:x:126:7:HPLIP system user,,,:/run/hplip:/bin/false
gdm:x:127:133:Gnome Display Manager:/var/lib/gdm3:/bin/false
userone:x:1000:1000:userone,,,:/home/userone:/usr/bin/zsh
fwupd-refresh:x:129:137:fwupd-refresh user,,,:/run/systemd:/usr/sbin/nologin
sshd:x:128:65534::/run/sshd:/usr/sbin/nologin
openvpn:x:130:136::/nonexistent:/usr/sbin/nologin
    """

    fake_id = "uid=0(root) gid=0(root) groups=0(root)"
    fake_uname = [
        "Darwin test.localdomain 22.2.0 Darwin Kernel Version 22.2.0: Fri Nov 11 02:03:51 PST 2022; root:xnu-8792.61.2~4/RELEASE_ARM64_T6000 arm64",
        "Linux ubuntu-ubuntu 5.15.0-58-generic #64-Ubuntu SMP Thu Jan 5 11:43:13 UTC 2023 x86_64 x86_64 x86_64 GNU/Linux"
    ]
    fake_sql_err = [
        "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''' at line 1",
        "ERROR: syntax error at or near \"'\"Position: 65```"
    ]

    fake_directory_ls = """
total 16K
drwxrwxr-x  2 user user 4.0K Jan 19 11:07 .
drwxrwxrwt 33 root root  12K Jan 19 11:07 ..
-rw-rw-r--  1 user user    0 Jan 19 11:07 file.txt
    """

    wp_robots = """
User-agent: *
Allow: /
Disallow: /wp-admin/
Allow: /wp-admin/admin-ajax.php
    """

    fake_xss_1 = "<script>alert(xss)</script>"
    fake_xss_2 = "<script>alert(document.domain)</script>"

    fake_aws_ssrf = {
        "AccessKey": {
            "UserName": "admin_management_user",
            "AccessKeyId": ''.join(random.choices(string.ascii_uppercase + string.ascii_lowercase + string.digits, k=16)),
            "Status": "Active",
            "SecretAccessKey": ''.join(random.choices(string.ascii_uppercase + string.ascii_lowercase + string.digits, k=32)),
            "CreateDate": str(datetime.now())
        }
    }

    aws_misconfig = "<ListBucketResult xmlns=\"\"/>"

    random_str_1 = ''.join(random.choices(string.ascii_uppercase + string.ascii_lowercase + string.digits, k=random.randint(256,512)))
    random_str_2 = ''.join(random.choices(string.ascii_uppercase + string.ascii_lowercase + string.digits, k=random.randint(256,512)))

    response_lst = [
        fake_etc_shadow,
        fake_etc_passwd,
        fake_id,
        fake_uname[random.randint(0, 1)],
        fake_sql_err[random.randint(0, 1)],
        fake_directory_ls,
        wp_robots,
        fake_xss_1,
        fake_xss_2,
        ujson.dumps(fake_aws_ssrf),
        aws_misconfig,
        random_str_1,
        random_str_2
    ]

    random.shuffle(response_lst)
    #rand_str = ''.join(random.choices(string.ascii_uppercase + string.ascii_lowercase + string.digits, k=16))
    response = f"<html><head><title>AWS S3 Explorer</title></head><body>" + '\n\n'.join(response_lst) + "</body></html>"
    #response = '\n\n'.join(response_lst)
    return response


@app.route('/<path:path>', methods=['GET', 'POST', 'HEAD', 'PUT', 'DELETE', 'OPTIONS', 'PATCH'])
async def server(request, path=""):
    echo = request.args.get('echo')
    if echo:
        encoded_echo = escape(echo)
        response_data = f"""
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Reflected Input Test</title>
        </head>
        <body>
            {encoded_echo}
        </body>
        </html>
        """
        return html(response_data, status=200)
    else:
        data = get_randomized_response()
        return text(data, status=200)


@app.on_response
async def add_request_id_header(request, response):
    echo = request.args.get('echo')
    if not echo:
        response.headers["Server"] = get_randomized_server_header()
        response.headers["X-Powered-By"] = get_randomized_xpowered_header()
        response.headers["Location"] = "https://aws.amazon.com/s3/"
        #response.headers["Content-Type"] = get_randomized_content_type_header()
        #response.headers['Content-Type'] = "text/html"


if __name__ == '__main__':
    app.run(
        host='0.0.0.0',
        port=8000,
        workers=16,
        debug=True)
